{% extends 'base.html' %}
{% load static %}

{% block title %}Place Order{% endblock %}

{% block main %}

<style>
/* hero image remove */
.hero_area .bg-box {
    display: none !important;
}
.hero_area {
    min-height: auto !important;
    padding-bottom: 0 !important;
}

/* navbar */
.header_section {
    background-color: #222831;
}

/* card design */
.order-box, .bill-box {
    background: white;
    max-width: 500px;
    margin: 30px auto;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 0 15px rgba(0,0,0,0.1);
}

.order-box h2,
.bill-box h2,
.bill-box h3 {
    text-align: center;
    margin-bottom: 20px;
}

/* form */
label {
    font-weight: 600;
    margin-top: 12px;
    display: block;
}

input, textarea, select {
    width: 100%;
    padding: 10px;
    margin-top: 6px;
    border-radius: 5px;
    border: 1px solid #ccc;
}

textarea {
    resize: none;
}

/* row for item & price */
.form-row {
    display: flex;
    gap: 15px;
}

.form-row .field {
    flex: 1;
}

/* button */
button {
    width: 100%;
    margin-top: 20px;
    padding: 12px;
    background: #e63946;
    color: white;
    border: none;
    font-size: 16px;
    border-radius: 5px;
    cursor: pointer;
}

button:hover {
    background: #c1121f;
}
</style>

{% if success %}
<!-- BILL SECTION -->
<div class="bill-box">
    <h2>âœ… Order Placed Successfully!</h2>
    <h3>ðŸ§¾ Bill</h3>

    <p><b>Item:</b> {{ item_name }}</p>
    <p><b>Price:</b> â‚¹{{ price }}</p>
    <p><b>Quantity:</b> {{ quantity }}</p>
    <p><b>Delivery Address:</b> {{ address }}</p>
    <p><b>Payment Method:</b> {{ payment_method }}</p>
    <hr>
    <p><b>Total:</b> â‚¹{{ total }}</p>

    <button onclick="window.print()">Print Bill</button>
</div>

{% else %}
<!-- ORDER FORM -->
<div class="order-box">
    <h2>Order Cake</h2>

    {% if error %}
        <p style="color:red; text-align:center;">{{ error }}</p>
    {% endif %}

    <form method="post">
        {% csrf_token %}

        <!-- Item + Price -->
        <div class="form-row">
            <div class="field">
                <label>Item Name</label>
                <select name="item_name" id="item_name" onchange="setPrice()" required>
                    <option value="">-- Select Item --</option>
                    <option value="chocolate cake">Chocolate Cake</option>
                    <option value="strawbeery_cake">Strawbeery Cake</option>
                    <option value="choco_pestry">Choco Pastry</option>
                    <option value="chocolate_sponge">Chocolate Sponge</option>
                    <option value="truffle_cake">Truffle Cake</option>
                    <option value="butterscooch_cake">Butterscotch Cake</option>
                    <option value="pineapple_cake">Pineapple Cake</option>
                    <option value="icecream_cake">Ice Cream Cake</option>
                    <option value="muffin">Muffin</option>
                    <option value="strawbeery_donut">Strawberry Donut</option>
                    <option value="chocolate_donot">Chocolate Donut</option>
                    <option value="jerry">Jerry</option>
                </select>
            </div>

            <div class="field">
                <label>Price</label>
                <input type="text" name="price" id="price" readonly>
            </div>
        </div>

        <label>Quantity</label>
        <input type="number" name="quantity" min="1" required>

        <label>Delivery Address</label>
        <textarea name="address" placeholder="Enter delivery address" required></textarea>

        <label>Payment Method</label>
        <select name="payment_method" required>
            <option value="">-- Select Payment Method --</option>
            <option value="COD">Cash On Delivery</option>
            <option value="UPI">UPI</option>
            <option value="Card">Card</option>
        </select>

        <button type="submit">Place Order</button>
    </form>
</div>
{% endif %}

<script>
function setPrice() {
    var item = document.getElementById("item_name").value;
    var priceField = document.getElementById("price");

    var prices = {
        "chocolate cake": 500,
        "strawbeery_cake": 560,
        "choco_pestry": 60,
        "chocolate_sponge": 560,
        "truffle_cake": 450,
        "butterscooch_cake": 550,
        "pineapple_cake": 450,
        "icecream_cake": 560,
        "muffin": 150,
        "strawbeery_donut": 140,
        "chocolate_donot": 200,
        "jerry": 210
    };

    priceField.value = prices[item] || "";
}
</script>

{% endblock %}